# Week 6: CI/CD Pipeline with GitHub Actions & Terraform

## ğŸ“‹ Project Overview

This project demonstrates a complete **CI/CD (Continuous Integration/Continuous Deployment)** pipeline using GitHub Actions to automatically deploy AWS infrastructure with Terraform. Every time code is pushed to the main branch, the infrastructure is validated, planned, and deployed to AWS automatically â€” no manual `terraform apply` needed!

**Built on Week 5 Lambda infrastructure, now fully automated.**

---

## ğŸ¯ Learning Objectives

- Understand what CI/CD is and why it matters in real DevOps jobs
- Build automated GitHub Actions workflows from scratch
- Store AWS credentials securely using GitHub Secrets
- Automate Terraform validate, plan, and apply in a pipeline
- Package and deploy Lambda functions automatically
- Debug and fix real pipeline errors

---

## ğŸ› ï¸ Tools & Technologies

| Tool | Purpose |
|------|---------|
| GitHub Actions | CI/CD automation platform (free!) |
| Terraform | Infrastructure as Code |
| AWS Lambda | Serverless function (Python 3.11) |
| AWS S3 | File storage with event triggers |
| AWS IAM | Permissions and access control |
| AWS CloudWatch | Logs and monitoring |
| Python 3.11 | Lambda runtime |
| Git & GitHub | Version control + automation trigger |

---

## ğŸ“‚ Project Structure

```
week6-cicd-terraform-automation/
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/
â”‚       â””â”€â”€ deploy.yml        â† GitHub Actions workflow (the magic!)
â”œâ”€â”€ lambda-function/
â”‚   â”œâ”€â”€ lambda_function.py    â† Python code for Lambda
â”‚   â”œâ”€â”€ requirements.txt      â† Python dependencies (Pillow)
â”‚   â””â”€â”€ package/              â† Auto-generated by workflow
â”œâ”€â”€ screenshots/              â† All documentation screenshots go here
â”œâ”€â”€ main.tf                   â† Main Terraform infrastructure
â”œâ”€â”€ variables.tf              â† Variable definitions
â”œâ”€â”€ outputs.tf                â† Deployment output values
â”œâ”€â”€ terraform.tfvars          â† Variable values (excluded from Git)
â”œâ”€â”€ .gitignore                â† Protects sensitive files
â””â”€â”€ README.md                 â† This file
```

---

## ğŸ§  What is CI/CD?

### Before CI/CD (Weeks 3â€“5 â€” Manual):
```
Write code â†’ terraform fmt â†’ terraform validate
â†’ terraform plan â†’ terraform apply â†’ check AWS
â†’ repeat every single time ğŸ˜©
```

### After CI/CD (Week 6 â€” Automated!):
```
Write code â†’ git push ğŸš€
â†’ GitHub Actions does EVERYTHING automatically
â†’ Check AWS â€” it's already deployed! â˜•
```

**GitHub Actions is the robot that replaces all the manual steps, every single time, with zero human error.**

---

## ğŸ—ï¸ Infrastructure Deployed (10 Resources)

| # | Resource | Name |
|---|---------|------|
| 1 | S3 Bucket | lambda-serverless-uploads-{account-id} |
| 2 | S3 Versioning | Enabled |
| 3 | S3 Public Access Block | All 4 settings blocked |
| 4 | IAM Role | lambda-serverless-lambda-execution-role |
| 5 | IAM S3 Policy | lambda-serverless-lambda-s3-policy |
| 6 | IAM CloudWatch Attachment | AWSLambdaBasicExecutionRole |
| 7 | CloudWatch Log Group | /aws/lambda/file-metadata-processor |
| 8 | Lambda Function | file-metadata-processor |
| 9 | Lambda Permission | Allow S3 to invoke Lambda |
| 10 | S3 Bucket Notification | Trigger Lambda on any upload |

---

## ğŸ“¸ SCREENSHOT 1 â€” VS Code Project Structure

> ğŸ“· **HOW TO TAKE:** Open VS Code. In the Explorer (left panel), expand all folders â€” especially `.github/workflows/`. Take a screenshot showing all files. Save as `screenshots/01-project-structure.png`

![VS Code Project Structure](screenshots/01-project-structure.png)

---

## âš™ï¸ The GitHub Actions Workflow

The entire automation lives in `.github/workflows/deploy.yml`. This file tells GitHub when to run, what machine to use, and what steps to execute.

**Trigger â€” when does it run?**
```yaml
on:
  push:
    branches:
      - main        # Deploys when you push to main âœ…
  pull_request:
    branches:
      - main        # Only validates on PRs â€” no deploy âŒ
```

**The conditional deploy â€” most important line!**
```yaml
- name: Terraform Apply
  if: github.ref == 'refs/heads/main' && github.event_name == 'push'
  run: terraform apply -auto-approve -input=false
```

This means push to main = full deploy. Pull request = validate only.

---

## ğŸ“¸ SCREENSHOT 2 â€” Workflow YAML File in VS Code

> ğŸ“· **HOW TO TAKE:** In VS Code, click on `.github/workflows/deploy.yml` to open it. Screenshot the full file content visible in the editor. Save as `screenshots/02-workflow-yaml.png`

![GitHub Actions Workflow YAML](screenshots/02-workflow-yaml.png)
![GitHub Actions Workflow YAML](screenshots/002-workflow-yaml.png)

---

## ğŸ” Setting Up AWS Credentials Securely

### IAM User for GitHub Actions

A dedicated IAM user called `github-actions-terraform` was created â€” never using personal credentials for automation!

---

## ğŸ“¸ SCREENSHOT 3 â€” IAM User in AWS Console

> ğŸ“· **HOW TO TAKE:** AWS Console â†’ IAM â†’ Users. Find and screenshot `github-actions-terraform` in the list. Save as `screenshots/03-iam-user-created.png`

![IAM User Created](screenshots/03-iam-user-created.png)

---

### GitHub Secrets

AWS credentials are stored encrypted in GitHub â€” never in code or Git history!

```yaml
# How workflow uses secrets â€” always shows as *** in logs!
env:
  AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
  AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
```

---

## ğŸ“¸ SCREENSHOT 4 â€” GitHub Secrets Page

> ğŸ“· **HOW TO TAKE:** Your GitHub repo â†’ Settings â†’ Secrets and variables â†’ Actions. Screenshot showing BOTH secrets listed. Values will be hidden â€” that is correct and expected! Save as `screenshots/04-github-secrets.png`

![GitHub Secrets Configured](screenshots/04-github-secrets.png)

---

## ğŸ”„ Pipeline Flow (What Happens After git push)

```
git push origin main
        â†“
GitHub detects push to main branch
        â†“
GitHub starts fresh Ubuntu VM (free!)
        â†“
Step 1: Download repo code          (2s)
Step 2: Install Terraform 1.6.0     (1s)
Step 3: Check code formatting       (0s)
Step 4: Build Lambda ZIP package    (30s) â† KEY STEP!
Step 5: terraform init              (10s)
Step 6: terraform validate          (1s)
Step 7: terraform plan              (5s)
Step 8: terraform apply             (10s) â† DEPLOYS TO AWS!
        â†“
10 AWS resources created in AWS
        â†“
Total time: ~57 seconds âœ…
```

**Why Step 4 matters:** The ZIP is in `.gitignore` so GitHub never has it.
The workflow builds it automatically every single run:
```bash
pip install -r requirements.txt --target ./package
cd package && zip -r ../lambda_function.zip . -q
zip -g lambda_function.zip lambda_function.py
```

---

## ğŸ› Real Error We Fixed

**Error on first pipeline run:**
```
Error: open lambda-function/lambda_function.zip: no such file or directory
```

Root cause: ZIP excluded from Git via `.gitignore`

Fix: Added "Build Lambda Deployment Package" step to create it automatically inside the pipeline. Professional solution â€” no committing ZIP files!

---

## ğŸ“¸ SCREENSHOT 5 â€” Failed Workflow Run (Learning Moment!)

> ğŸ“· **HOW TO TAKE:** GitHub â†’ Actions tab â†’ Find the failed run (red X icon). Click into it and screenshot the error message showing "no such file or directory". Save as `screenshots/05-pipeline-error.png`

![Pipeline Error Learning Moment](screenshots/05-pipeline-error.png)

---

## ğŸ‰ Successful Deployment

After adding the Lambda package build step, the pipeline succeeded!

---

## ğŸ“¸ SCREENSHOT 6 â€” GitHub Actions Success â­ (Most Important!)

> ğŸ“· **HOW TO TAKE:** GitHub repo â†’ Actions tab. Find the successful run with the green checkmark âœ…. Screenshot showing the run name, "main" branch badge, and the time taken (57s). Save as `screenshots/06-github-actions-success.png`

![GitHub Actions Success](screenshots/06-github-actions-success.png)

---

## ğŸ“¸ SCREENSHOT 7 â€” All Pipeline Steps Green

> ğŸ“· **HOW TO TAKE:** Click on the successful run â†’ Click "Terraform Deploy" job â†’ Expand ALL steps. Screenshot showing every single step with a green checkmark. Save as `screenshots/07-all-steps-green.png`

![All Pipeline Steps Green](screenshots/07-all-steps-green.png)

---

## ğŸ“¸ SCREENSHOT 8 â€” Terraform Apply Output in Logs

> ğŸ“· **HOW TO TAKE:** Inside the workflow run logs, click the "Terraform Apply" step to expand it. Screenshot showing "Apply complete! Resources: 10 added, 0 changed, 0 destroyed" and the Outputs section. Save as `screenshots/08-terraform-apply-output.png`

![Terraform Apply Output](screenshots/08-terraform-apply-output.png)

---

## âœ… AWS Console Verification

### Lambda Function

---

## ğŸ“¸ SCREENSHOT 9 â€” Lambda Function in AWS Console

> ğŸ“· **HOW TO TAKE:** AWS Console â†’ Lambda â†’ Functions. Screenshot showing `file-metadata-processor` in the list with Python 3.11 runtime and a recent "Last modified" timestamp. Save as `screenshots/09-lambda-deployed.png`

![Lambda Deployed by CI/CD](screenshots/09-lambda-deployed.png)

---

## ğŸ“¸ SCREENSHOT 10 â€” Lambda Configuration Tab

> ğŸ“· **HOW TO TAKE:** Click `file-metadata-processor` â†’ Configuration tab â†’ General configuration. Screenshot showing Memory: 512 MB and Timeout: 30 seconds. Save as `screenshots/10-lambda-config.png`

![Lambda Function Configuration](screenshots/10-lambda-config.png)

---

### S3 Bucket

---

## ğŸ“¸ SCREENSHOT 11 â€” S3 Bucket in AWS Console

> ğŸ“· **HOW TO TAKE:** AWS Console â†’ S3. Screenshot showing `lambda-serverless-uploads-{your-account-id}` in the bucket list with eu-west-1 region and creation date. Save as `screenshots/11-s3-bucket.png`

![S3 Bucket Created](screenshots/11-s3-bucket.png)

---

## ğŸ“¸ SCREENSHOT 12 â€” S3 Bucket Properties

> ğŸ“· **HOW TO TAKE:** Click your S3 bucket â†’ Properties tab. Screenshot showing Bucket Versioning: Enabled and Default encryption section. Save as `screenshots/12-s3-properties.png`

![S3 Bucket Properties](screenshots/12-s3-properties.png)
![S3 Bucket Properties](screenshots/012-s3-properties.png)
---

### IAM Role

---

## ğŸ“¸ SCREENSHOT 13 â€” IAM Role in AWS Console

> ğŸ“· **HOW TO TAKE:** AWS Console â†’ IAM â†’ Roles â†’ Search `lambda-serverless-lambda-execution-role`. Screenshot showing it in the results list. Save as `screenshots/13-iam-role.png`

![IAM Role Created](screenshots/13-iam-role.png)

---

### CloudWatch Logs

---

## ğŸ“¸ SCREENSHOT 14 â€” CloudWatch Log Group

> ğŸ“· **HOW TO TAKE:** AWS Console â†’ CloudWatch â†’ Log groups. Screenshot showing `/aws/lambda/file-metadata-processor` in the list with 7 days retention. Save as `screenshots/14-cloudwatch-log-group.png`

![CloudWatch Log Group](screenshots/14-cloudwatch-log-group.png)

---

## ğŸ§ª Testing the Lambda Function

```bash
# Upload a test file â€” Lambda triggers automatically!
echo "Hello from CI/CD Week 6!" > test.txt
aws s3 cp test.txt s3://lambda-serverless-uploads-150502622892/
```

Lambda processes it and saves a metadata JSON to S3:

```json
{
  "fileName": "test.txt",
  "bucketName": "lambda-serverless-uploads-150502622892",
  "fileSize": 26,
  "fileSizeReadable": "26.00 B",
  "contentType": "text/plain",
  "uploadTime": "2026-02-16T14:50:22"
}
```

---

## ğŸ“¸ SCREENSHOT 15 â€” Lambda Execution Logs in CloudWatch

> ğŸ“· **HOW TO TAKE:** CloudWatch â†’ Log groups â†’ `/aws/lambda/file-metadata-processor` â†’ Click a log stream. Screenshot the execution showing START, processing messages, END, and the REPORT line (Duration, Memory Used). Save as `screenshots/15-lambda-execution-logs.png`

![Lambda Execution Logs](screenshots/15-lambda-execution-logs.png)

---

## ğŸ’¡ Key Learnings

### CI/CD Value

| Before CI/CD | After CI/CD |
|-------------|------------|
| ~15 minutes manual deploy | 57 seconds automated |
| Easy to forget steps | Every step always runs |
| Human errors possible | Zero human error |
| No record of deployments | Full log of every run |
| Hard to collaborate | Team deploys safely |

### Security Lessons

- âœ… Never commit AWS credentials to Git (use GitHub Secrets!)
- âœ… Dedicated IAM user for automation â€” not personal credentials
- âœ… Programmatic access only â€” robots do not need console login
- âœ… Block all S3 public access â€” 4-layer protection
- âœ… Credentials always show as `***` in pipeline logs

### Debugging is Normal!

The pipeline failed on the first attempt. That is completely normal in real DevOps work. The key skill is reading the error message carefully and finding the fix. We went from error to success systematically, exactly like professional engineers do every day.

---

## ğŸ“Š Deployment Summary

| Metric | Value |
|--------|-------|
| Resources deployed | 10 AWS resources |
| Deployment time | 57 seconds |
| Manual steps | 0 (fully automated!) |
| Pipeline runs total | 10 (debugging included) |
| AWS region | eu-west-1 (Europe/Ireland) |
| Monthly cost | ~$0 (within free tier) |

---

## ğŸ§¹ Cleanup â€” Avoid AWS Charges!

When done testing, destroy all resources:

```bash
terraform init
terraform destroy
# Type 'yes' when prompted
```

Expected output:
```
Destroy complete! Resources: 10 destroyed.
```

**After destroy: $0 charges** âœ…

---

## âœ… Screenshot Checklist

Track which screenshots you still need to take:

- [ ] `01-project-structure.png` â€” VS Code Explorer with all files visible
- [ ] `02-workflow-yaml.png` â€” deploy.yml open in VS Code editor
- [ ] `03-iam-user-created.png` â€” github-actions-terraform user in IAM
- [ ] `04-github-secrets.png` â€” Both secrets in GitHub Settings
- [ ] `05-pipeline-error.png` â€” The failed run showing the ZIP error
- [ ] `06-github-actions-success.png` â€” Green checkmark workflow â­
- [ ] `07-all-steps-green.png` â€” All pipeline steps expanded and green
- [ ] `08-terraform-apply-output.png` â€” "Apply complete! 10 added" in logs
- [ ] `09-lambda-deployed.png` â€” Lambda function in AWS Console
- [ ] `10-lambda-config.png` â€” Lambda Configuration tab
- [ ] `11-s3-bucket.png` â€” S3 bucket in AWS Console
- [ ] `12-s3-properties.png` â€” S3 Properties (versioning + encryption on)
- [ ] `13-iam-role.png` â€” IAM role in AWS Console
- [ ] `14-cloudwatch-log-group.png` â€” CloudWatch log group
- [ ] `15-lambda-execution-logs.png` â€” Lambda execution logs

---

## ğŸ”— Resources

- [GitHub Actions Documentation](https://docs.github.com/en/actions)
- [Terraform AWS Provider](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)
- [AWS Lambda Documentation](https://docs.aws.amazon.com/lambda/)
- [GitHub Secrets Guide](https://docs.github.com/en/actions/security-guides/encrypted-secrets)

---

## ğŸ“ Week 7 Ideas

- **Cloud Monitoring** â€” CloudWatch dashboards and billing alarms
- **Auto Scaling** â€” Scale EC2 automatically based on load
- **Load Balancer** â€” Distribute traffic across multiple servers
- **Advanced IAM** â€” Fine-grained security policies

---

## ğŸ‘¨â€ğŸ’» Author

**Offong Bassey**
GitHub: [@offongbassey](https://github.com/offongbassey)
Completed: February 16, 2026
Part of: 12-Week Cloud Computing Challenge

---

*This infrastructure was deployed automatically by GitHub Actions â€” zero manual steps! ğŸ¤–*
